# GMC Sentinela - Descri√ß√£o Detalhada da Aplica√ß√£o

## üìã Vis√£o Geral

**GMC Sentinela** √© uma plataforma web completa de gest√£o operacional para Guardas Municipais, desenvolvida com tecnologias modernas (React, TypeScript, Supabase) e focada em otimizar o controle e monitoramento das opera√ß√µes de seguran√ßa municipal.

---

## üéØ Objetivo Principal

Centralizar e automatizar a gest√£o de opera√ß√µes da Guarda Municipal, incluindo:
- Rastreamento de viaturas em tempo real
- Registro e acompanhamento de ocorr√™ncias
- Gest√£o de guarni√ß√µes e escalas de trabalho
- Controle de manuten√ß√£o de viaturas
- Processos de corregedoria e sindic√¢ncias
- Sistema de alertas e notifica√ß√µes

---

## üèóÔ∏è Arquitetura T√©cnica

### **Stack Tecnol√≥gico**
- **Frontend**: React 18 + TypeScript + Vite
- **UI Framework**: Shadcn/ui + Tailwind CSS
- **Backend**: Supabase (PostgreSQL + Edge Functions)
- **Mapas**: Google Maps API / Leaflet
- **Gr√°ficos**: ECharts / Recharts
- **Autentica√ß√£o**: Supabase Auth
- **Estado Global**: React Context API + TanStack Query

### **Estrutura do Projeto**
```
src/
‚îú‚îÄ‚îÄ components/       # Componentes reutiliz√°veis
‚îÇ   ‚îú‚îÄ‚îÄ Dashboard/    # Componentes do painel principal
‚îÇ   ‚îú‚îÄ‚îÄ Ocorrencias/  # Gest√£o de ocorr√™ncias
‚îÇ   ‚îú‚îÄ‚îÄ Viaturas/     # Gest√£o de viaturas
‚îÇ   ‚îú‚îÄ‚îÄ Inspetoria/   # M√≥dulo de inspetoria
‚îÇ   ‚îú‚îÄ‚îÄ Corregedoria/ # M√≥dulo de corregedoria
‚îÇ   ‚îî‚îÄ‚îÄ Configuracoes/# Configura√ß√µes do sistema
‚îú‚îÄ‚îÄ pages/           # P√°ginas da aplica√ß√£o
‚îú‚îÄ‚îÄ services/        # Servi√ßos e APIs
‚îú‚îÄ‚îÄ hooks/           # Hooks customizados
‚îú‚îÄ‚îÄ contexts/        # Contextos React
‚îú‚îÄ‚îÄ types/           # Defini√ß√µes TypeScript
‚îî‚îÄ‚îÄ database/        # Migra√ß√µes SQL
```

---

## üì± M√≥dulos e Funcionalidades

### 1. **Dashboard / Centro de Comando**

#### **P√°gina Inicial (Index)**
- **Estat√≠sticas em Tempo Real**:
  - Viaturas em opera√ß√£o
  - Ocorr√™ncias ativas
  - Efetivo em servi√ßo
  - Alertas de manuten√ß√£o

- **Visualiza√ß√µes com Tabs**:
  - **Mapa de Ocorr√™ncias**: Visualiza√ß√£o geogr√°fica de todas as ocorr√™ncias registradas
  - **Rastreamento de Viaturas**: Monitoramento em tempo real da localiza√ß√£o das viaturas

- **Tabelas Informativas**:
  - Lista de viaturas ativas com status
  - Lista de ocorr√™ncias recentes

#### **Dashboard Executivo**
- **Cabe√ßalho de Boas-Vindas**: Personalizado com nome e cargo do usu√°rio
- **Estat√≠sticas R√°pidas (QuickStats)**: M√©tricas operacionais principais
- **A√ß√µes R√°pidas (QuickActions)**: Atalhos para fun√ß√µes frequentes
- **Mural de Alertas**: Exibi√ß√£o de alertas importantes (m√°ximo 3 na p√°gina inicial)
- **Grid de Dados**: Visualiza√ß√µes de rotas de patrulha e escalas de trabalho

---

### 2. **Gest√£o de Ocorr√™ncias**

#### **Funcionalidades**:
- **Registro de Nova Ocorr√™ncia**:
  - Formul√°rio completo com valida√ß√£o
  - Campos: tipo, localiza√ß√£o, descri√ß√£o, gravidade, envolvidos
  - Upload de anexos (fotos, documentos)
  - Geolocaliza√ß√£o autom√°tica

- **Lista de Ocorr√™ncias**:
  - Visualiza√ß√£o em tabela com filtros
  - Status: Aberta, Em Andamento, Resolvida, Arquivada
  - Busca por data, tipo, localiza√ß√£o
  - Exporta√ß√£o de relat√≥rios

- **Detalhes da Ocorr√™ncia**:
  - Visualiza√ß√£o completa de informa√ß√µes
  - Hist√≥rico de atualiza√ß√µes
  - Anexos e evid√™ncias
  - Linha do tempo de a√ß√µes
  - Atribui√ß√£o de respons√°veis

#### **Tipos de Ocorr√™ncia**:
- Perturba√ß√£o da ordem
- Furto/Roubo
- Acidente de tr√¢nsito
- Viol√™ncia dom√©stica
- Dano ao patrim√¥nio p√∫blico
- Outros

---

### 3. **Gest√£o de Viaturas**

#### **Cadastro de Viaturas**:
- **Informa√ß√µes B√°sicas**:
  - C√≥digo/Prefixo
  - Modelo e marca
  - Placa
  - Ano de fabrica√ß√£o
  - Tipo (patrulha, administrativa, especial)
  - Status operacional

- **Documenta√ß√£o**:
  - CRLV
  - Seguro
  - Vencimentos e renova√ß√µes

#### **Controle de Manuten√ß√£o**:
- **Registro de Manuten√ß√µes**:
  - Preventiva / Corretiva
  - Data e quilometragem
  - Descri√ß√£o do servi√ßo
  - Custo
  - Respons√°vel
  - Anexos (notas fiscais, fotos)

- **Alertas Autom√°ticos**:
  - Manuten√ß√£o preventiva vencida
  - Documenta√ß√£o a vencer
  - Quilometragem para revis√£o

#### **Relat√≥rios**:
- Hist√≥rico de manuten√ß√µes por viatura
- Custos mensais/anuais
- Disponibilidade da frota
- Gr√°ficos de desempenho

#### **Rastreamento**:
- Localiza√ß√£o em tempo real no mapa
- Hist√≥rico de rotas
- Status: Em Patrulha, Dispon√≠vel, Em Manuten√ß√£o, Indispon√≠vel

---

### 4. **Inspetoria Geral**

#### **Dashboard Operacional**:
- Vis√£o geral das opera√ß√µes
- Estat√≠sticas de guarni√ß√µes ativas
- Ocorr√™ncias por regi√£o
- Efetivo em campo

#### **Gest√£o de Guarni√ß√µes**:
- **Cadastro de Guarni√ß√µes**:
  - Nome da guarni√ß√£o
  - Supervisor respons√°vel
  - Membros da equipe (nome, fun√ß√£o, matr√≠cula)
  - Observa√ß√µes

- **Listagem e Edi√ß√£o**:
  - Visualiza√ß√£o de todas as guarni√ß√µes
  - Edi√ß√£o de membros
  - Hist√≥rico de altera√ß√µes

#### **Escala de Trabalho**:
- **Cria√ß√£o de Escalas**:
  - Sele√ß√£o de guarni√ß√£o
  - Defini√ß√£o de rota
  - Atribui√ß√£o de viatura
  - Per√≠odo (diurno/noturno)
  - Dias da semana ativos

- **Visualiza√ß√£o**:
  - Calend√°rio semanal/mensal
  - Filtros por guarni√ß√£o, rota, per√≠odo
  - Exporta√ß√£o para PDF

#### **Rotas de Patrulhamento**:
- **Cadastro de Rotas**:
  - Nome da rota
  - Descri√ß√£o
  - Pontos de interesse
  - √Årea de cobertura
  - Prioridade

- **Visualiza√ß√£o no Mapa**:
  - Tra√ßado da rota
  - Pontos cr√≠ticos
  - Hist√≥rico de patrulhas

#### **Relat√≥rios Operacionais**:
- Relat√≥rios de atividades por per√≠odo
- Desempenho de guarni√ß√µes
- Cobertura territorial
- Ocorr√™ncias atendidas

#### **Mural de Alertas**:
- **Cria√ß√£o de Alertas**:
  - T√≠tulo e descri√ß√£o
  - Tipo (informativo, urgente, cr√≠tico)
  - Data de validade
  - Destinat√°rios

- **Gerenciamento**:
  - Edi√ß√£o e exclus√£o
  - Marca√ß√£o como lido
  - Notifica√ß√µes push

---

### 5. **Corregedoria**

#### **Gest√£o de Sindic√¢ncias**:
- **Nova Sindic√¢ncia**:
  - N√∫mero do processo
  - Data de abertura
  - Investigado (nome, matr√≠cula)
  - Motivo/Den√∫ncia
  - Relato inicial
  - Anexos (documentos, evid√™ncias)

- **Acompanhamento**:
  - Status: Aberta, Em Andamento, Conclu√≠da, Arquivada
  - Etapa atual do processo
  - Respons√°vel pela investiga√ß√£o

- **Etapas da Investiga√ß√£o**:
  - Cria√ß√£o de etapas personalizadas
  - Descri√ß√£o e respons√°vel
  - Data de conclus√£o
  - Marca√ß√£o de conclus√£o

- **Estat√≠sticas**:
  - Total de investiga√ß√µes
  - Por status
  - Tempo m√©dio de conclus√£o
  - Gr√°ficos de tend√™ncias

#### **Documenta√ß√£o**:
- Upload de documentos
- Anexos organizados por etapa
- Hist√≥rico de altera√ß√µes
- Controle de acesso restrito

---

### 6. **Configura√ß√µes do Sistema**

#### **Gest√£o de Usu√°rios**:
- **Cadastro de Usu√°rios**:
  - Nome completo
  - Email
  - Matr√≠cula
  - Data de nascimento
  - Perfil/Cargo
  - Status (ativo/inativo)
  - Senha

- **Perfis de Acesso**:
  - Administrador: Acesso total
  - Inspetor: Gest√£o operacional
  - Agente: Acesso limitado
  - Corregedoria: Acesso a sindic√¢ncias
  - Personalizado: Permiss√µes customizadas

- **Listagem e Edi√ß√£o**:
  - Tabela com todos os usu√°rios
  - Filtros e busca
  - Edi√ß√£o de perfil e status
  - Redefini√ß√£o de senha

#### **Integra√ß√µes de APIs**:
- **Google Maps API**:
  - Configura√ß√£o da chave de API
  - Armazenamento seguro (criptografado)
  - Sincroniza√ß√£o com arquivo .env
  - Teste de conectividade

- **Webhooks de Notifica√ß√£o**:
  - Integra√ß√£o com n8n, Zapier, etc.
  - Configura√ß√£o de eventos:
    - Nova ocorr√™ncia
    - Altera√ß√£o de status
    - Novo alerta
    - Manuten√ß√£o vencida
  - URL do webhook (apenas HTTPS)
  - Ativa√ß√£o/desativa√ß√£o por evento
  - Log de notifica√ß√µes enviadas

#### **Notifica√ß√µes**:
- Prefer√™ncias de notifica√ß√µes (a ser implementado)
- Canais: Email, Push, SMS
- Frequ√™ncia e hor√°rios

---

## üîê Seguran√ßa e Autentica√ß√£o

### **Sistema de Login**:
- Autentica√ß√£o via Supabase Auth
- Email e senha
- Valida√ß√£o de credenciais
- Sess√£o persistente

### **Recupera√ß√£o de Senha**:
- Envio de email com link de redefini√ß√£o
- Token de seguran√ßa tempor√°rio
- Valida√ß√£o de nova senha

### **Controle de Acesso**:
- **Row Level Security (RLS)** no Supabase
- Pol√≠ticas baseadas em perfil do usu√°rio
- Prote√ß√£o de rotas no frontend
- Componente `ProtectedRoute` para valida√ß√£o

### **Armazenamento Seguro**:
- Chaves de API criptografadas
- Dados sens√≠veis protegidos
- Logs de auditoria
- Backup autom√°tico

---

## üìä Banco de Dados

### **Tabelas Principais**:

#### **Usu√°rios e Autentica√ß√£o**:
- `users`: Dados dos usu√°rios
- `profiles`: Perfis e permiss√µes

#### **Opera√ß√µes**:
- `occurrences`: Ocorr√™ncias registradas
- `vehicles`: Viaturas cadastradas
- `vehicle_maintenance`: Manuten√ß√µes
- `guarnicoes`: Guarni√ß√µes
- `guarnicao_membros`: Membros das guarni√ß√µes
- `rotas`: Rotas de patrulhamento
- `escalas`: Escalas de trabalho

#### **Corregedoria**:
- `investigacoes`: Sindic√¢ncias
- `etapas_investigacao`: Etapas dos processos
- `investigacao_anexos`: Anexos

#### **Sistema**:
- `system_api_keys`: Chaves de API
- `system_webhooks`: Configura√ß√µes de webhooks
- `webhook_notification_log`: Log de notifica√ß√µes
- `system_env_updates`: Hist√≥rico de atualiza√ß√µes
- `alerts`: Alertas do sistema

---

## üó∫Ô∏è Funcionalidades de Mapeamento

### **Mapas Interativos**:
- **Mapa de Ocorr√™ncias**:
  - Marcadores por tipo de ocorr√™ncia
  - Cores por gravidade
  - Popup com informa√ß√µes
  - Filtros por data e tipo
  - Clustering de marcadores

- **Rastreamento de Viaturas**:
  - Localiza√ß√£o em tempo real
  - √çcones personalizados por tipo
  - Status da viatura
  - Hist√≥rico de rotas
  - Geofencing (√°reas de cobertura)

- **Rotas de Patrulhamento**:
  - Desenho de rotas no mapa
  - Pontos de interesse
  - √Åreas priorit√°rias
  - Sobreposi√ß√£o de m√∫ltiplas rotas

### **Geolocaliza√ß√£o**:
- Captura autom√°tica de coordenadas
- Endere√ßo reverso (coordenadas ‚Üí endere√ßo)
- Busca por endere√ßo
- C√°lculo de dist√¢ncias

---

## üìà Relat√≥rios e Estat√≠sticas

### **Dashboards Anal√≠ticos**:
- Gr√°ficos de ocorr√™ncias por tipo
- Tend√™ncias temporais
- Mapas de calor
- Comparativos mensais/anuais

### **Exporta√ß√£o**:
- PDF
- Excel/CSV
- Impress√£o otimizada

### **M√©tricas Operacionais**:
- Taxa de resolu√ß√£o de ocorr√™ncias
- Tempo m√©dio de resposta
- Disponibilidade da frota
- Efici√™ncia de guarni√ß√µes
- Custos operacionais

---

## üîî Sistema de Alertas e Notifica√ß√µes

### **Tipos de Alertas**:
- **Informativo**: Avisos gerais
- **Urgente**: Requer aten√ß√£o
- **Cr√≠tico**: A√ß√£o imediata necess√°ria

### **Canais de Notifica√ß√£o**:
- Notifica√ß√µes in-app
- Webhooks para sistemas externos
- Email (configur√°vel)
- Push notifications (PWA)

### **Eventos Notific√°veis**:
- Nova ocorr√™ncia registrada
- Altera√ß√£o de status de ocorr√™ncia
- Manuten√ß√£o vencida
- Documenta√ß√£o a vencer
- Novo alerta criado
- Atribui√ß√£o de tarefa

---

## üé® Interface do Usu√°rio

### **Design System**:
- **Cores Principais**:
  - GCM Primary: Azul institucional (#1e40af)
  - GCM Secondary: Verde (#16a34a)
  - Alertas: Vermelho (#dc2626)
  - Avisos: √Çmbar (#f59e0b)

- **Componentes UI**:
  - Shadcn/ui (biblioteca de componentes)
  - Tailwind CSS (estiliza√ß√£o)
  - Lucide Icons (√≠cones)
  - Anima√ß√µes suaves (fade-in, slide)

### **Responsividade**:
- Mobile-first design
- Breakpoints: sm, md, lg, xl
- Navega√ß√£o adaptativa
- Tabelas responsivas com scroll

### **Acessibilidade**:
- Contraste adequado (WCAG AA)
- Navega√ß√£o por teclado
- Labels descritivos
- Feedback visual claro

---

## üöÄ Funcionalidades Avan√ßadas

### **PWA (Progressive Web App)**:
- Instal√°vel em dispositivos m√≥veis
- Funciona offline (cache)
- Notifica√ß√µes push
- √çcones e splash screen personalizados

### **Otimiza√ß√µes de Performance**:
- Lazy loading de componentes
- Code splitting
- Caching de dados (TanStack Query)
- Compress√£o de imagens
- Minifica√ß√£o de assets

### **Integra√ß√£o com n8n**:
- Automa√ß√£o de workflows
- Notifica√ß√µes para equipes (Slack, Teams)
- Sincroniza√ß√£o com outros sistemas
- Relat√≥rios autom√°ticos

---

## üì¶ Deployment e Infraestrutura

### **Ambiente de Desenvolvimento**:
- Vite dev server
- Hot Module Replacement (HMR)
- TypeScript strict mode
- ESLint + Prettier

### **Produ√ß√£o**:
- Build otimizado com Vite
- Deploy em Netlify/Vercel
- CDN para assets est√°ticos
- SSL/HTTPS obrigat√≥rio

### **Banco de Dados**:
- Supabase (PostgreSQL)
- Backups autom√°ticos
- Replica√ß√£o
- Monitoramento de performance

---

## üîÑ Fluxos de Trabalho Principais

### **1. Registro de Ocorr√™ncia**:
```
Agente ‚Üí Preenche formul√°rio ‚Üí Upload de evid√™ncias ‚Üí 
Geolocaliza√ß√£o ‚Üí Salva no banco ‚Üí Notifica supervisor ‚Üí 
Atualiza mapa ‚Üí Envia webhook
```

### **2. Manuten√ß√£o de Viatura**:
```
Inspetor ‚Üí Identifica necessidade ‚Üí Registra manuten√ß√£o ‚Üí 
Atualiza status da viatura ‚Üí Agenda servi√ßo ‚Üí 
Anexa documentos ‚Üí Notifica respons√°vel ‚Üí 
Atualiza relat√≥rios
```

### **3. Cria√ß√£o de Escala**:
```
Inspetor ‚Üí Seleciona guarni√ß√£o ‚Üí Define rota ‚Üí 
Atribui viatura ‚Üí Define per√≠odo ‚Üí Salva escala ‚Üí 
Notifica equipe ‚Üí Atualiza dashboard
```

### **4. Sindic√¢ncia**:
```
Corregedoria ‚Üí Abre processo ‚Üí Registra den√∫ncia ‚Üí 
Cria etapas ‚Üí Anexa documentos ‚Üí Atualiza status ‚Üí 
Notifica envolvidos ‚Üí Gera relat√≥rio final
```

---

## üìã Requisitos do Sistema

### **Navegadores Suportados**:
- Chrome/Edge 90+
- Firefox 88+
- Safari 14+
- Opera 76+

### **Dispositivos**:
- Desktop (Windows, macOS, Linux)
- Tablets (iOS, Android)
- Smartphones (iOS, Android)

### **Conex√£o**:
- Recomendado: 5 Mbps ou superior
- Funciona offline (funcionalidades limitadas)

---

## üéì Casos de Uso

### **Cen√°rio 1: Patrulha Di√°ria**
Um agente inicia sua ronda seguindo a rota definida na escala. Durante o patrulhamento, identifica uma perturba√ß√£o da ordem. Atrav√©s do app m√≥vel, registra a ocorr√™ncia com fotos, localiza√ß√£o autom√°tica e descri√ß√£o. O sistema notifica o supervisor imediatamente e atualiza o mapa de ocorr√™ncias em tempo real.

### **Cen√°rio 2: Gest√£o de Frota**
O inspetor recebe um alerta de que uma viatura est√° pr√≥xima da quilometragem para manuten√ß√£o preventiva. Acessa o m√≥dulo de viaturas, agenda a manuten√ß√£o, atualiza o status para "Em Manuten√ß√£o" e realoca a guarni√ß√£o para outra viatura dispon√≠vel. Ap√≥s o servi√ßo, registra os custos e anexa a nota fiscal.

### **Cen√°rio 3: Investiga√ß√£o Interna**
A corregedoria recebe uma den√∫ncia contra um agente. Abre uma sindic√¢ncia no sistema, registra o relato inicial, cria as etapas da investiga√ß√£o (oitiva, an√°lise de documentos, conclus√£o), atribui respons√°veis e define prazos. Conforme as etapas s√£o conclu√≠das, o sistema atualiza o status e notifica os envolvidos.

---

## üîÆ Roadmap Futuro

### **Funcionalidades Planejadas**:
- [ ] Integra√ß√£o com c√¢meras de seguran√ßa
- [ ] Reconhecimento facial
- [ ] An√°lise preditiva de ocorr√™ncias
- [ ] App mobile nativo (React Native)
- [ ] Chatbot para atendimento
- [ ] Integra√ß√£o com 190
- [ ] Dashboard para cidad√£os
- [ ] API p√∫blica para desenvolvedores
- [ ] M√≥dulo de treinamento e capacita√ß√£o
- [ ] Sistema de ponto eletr√¥nico

---

## üìû Suporte e Manuten√ß√£o

### **Documenta√ß√£o**:
- Manual do usu√°rio
- Guias de instala√ß√£o
- API documentation
- V√≠deos tutoriais

### **Suporte T√©cnico**:
- Email: suporte@gmcsentinela.com
- Chat in-app
- Base de conhecimento
- FAQ

---

## üìÑ Licen√ßa e Propriedade

**GMC Sentinela** √© uma aplica√ß√£o propriet√°ria desenvolvida para uso exclusivo de Guardas Municipais. Todos os direitos reservados.

---

## üèÜ Diferenciais Competitivos

1. **Interface Intuitiva**: Design moderno e f√°cil de usar
2. **Tempo Real**: Atualiza√ß√µes instant√¢neas em todos os m√≥dulos
3. **Multiplataforma**: Funciona em qualquer dispositivo
4. **Seguran√ßa**: Criptografia e controle de acesso robusto
5. **Escalabilidade**: Suporta crescimento da opera√ß√£o
6. **Integra√ß√£o**: Conecta-se com sistemas externos
7. **Customiza√ß√£o**: Adapt√°vel √†s necessidades espec√≠ficas
8. **Suporte**: Documenta√ß√£o completa e suporte t√©cnico

---

## üìä M√©tricas de Sucesso

- **Redu√ß√£o de 40%** no tempo de registro de ocorr√™ncias
- **Aumento de 60%** na efici√™ncia de patrulhamento
- **Diminui√ß√£o de 30%** nos custos de manuten√ß√£o
- **Melhoria de 50%** na comunica√ß√£o entre equipes
- **100%** de rastreabilidade de processos

---

**Desenvolvido com ‚ù§Ô∏è para tornar as opera√ß√µes da Guarda Municipal mais eficientes e seguras.**
